function initialize(){var e=new google.maps.LatLng(40.7680441,-73.9845662),o=document.getElementById("map"),a={center:e,zoom:13,mapTypeId:google.maps.MapTypeId.ROADMAP};map=new google.maps.Map(o,a),infowindow=new google.maps.InfoWindow({maxWidth:200});for(var n=0;n<attractions().length;n++)createMarker(attractions()[n].position,attractions()[n].name),clickMarker(markers()[n],markers()[n].title)}var attractions=ko.observableArray([{name:"Central Park",position:{lat:40.7828647,lng:-73.9675491}},{name:"Empire State Building",position:{lat:40.7484404,lng:-73.9878494}},{name:"Madison Square Garden",position:{lat:40.7505045,lng:-73.9956327}},{name:"Times Square",position:{lat:40.758895,lng:-73.987325}},{name:"American Museum of Natural History",position:{lat:40.7813241,lng:-73.9761822}},{name:"Museum of Modern Art",position:{lat:40.7614327,lng:-73.9798156}},{name:"Columbus Circle",position:{lat:40.7680441,lng:-73.9845662}}]),map,infowindow,marker,markers=ko.observableArray();"undefined"!=typeof google?google.maps.event.addDomListener(window,"load",initialize):$("#map").html("<h4>Oops...There are errors when retrieving map data. Please try refresh page later.</h4>");var createMarker=function(e,o){marker=new google.maps.Marker({position:new google.maps.LatLng(e),title:o,animation:google.maps.Animation.DROP,map:map}),markers.push(marker)},clickMarker=function(e,o){google.maps.event.addListener(e,"click",function(e){return function(){e.setAnimation(google.maps.Animation.BOUNCE),setTimeout(function(){e.setAnimation(null)},725),getWikiRecourse(e,o),google.maps.event.addListenerOnce(e,"visible_changed",function(){infowindow.close()})}}(e))},getWikiRecourse=function(e,o){var a="http://en.wikipedia.org/w/api.php?action=opensearch&search="+o+"&format=json&callback=wikiCallback",n=setTimeout(function(){infowindow.setContent("Wikipedia Article Could Not Be Loaded. Please try request data later."),infowindow.open(map,e)},2e3);$.ajax({url:a,dataType:"jsonp",jsonp:"callback",success:function(o){var a=o[0],i="http://en.wikipedia.org/wiki/"+a;content=o[2][0],infowindow.setContent("<h4>"+a+"</h4>"+content+'<p><a href="'+i+'" target="_blank">More about '+a+"</a></p>"),infowindow.open(map,e),clearTimeout(n)}})},ViewModel=function(){var e=this;e.locations=markers,e.query=ko.observable(""),e.clickHandler=function(e){google.maps.event.trigger(e,"click")},e.search=ko.computed(function(){return ko.utils.arrayFilter(e.locations(),function(o){var a=o.title.toLowerCase().indexOf(e.query().toLowerCase())>=0;return o.setVisible(a),a})})},viewModel=new ViewModel;ko.applyBindings(viewModel);